//= require jquery/dist/jquery
//= require underscore/underscore
//= require backbone/backbone
//= require nouislider/distribute/jquery.nouislider.all
// Generated by CoffeeScript 1.7.1
(function() {
  var Backbone, global, _,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  global = typeof exports !== "undefined" && exports !== null ? exports : window;

  _ = (typeof exports !== 'undefined' ? require('underscore') : global)._;

  Backbone = typeof exports !== 'undefined' ? require('backbone') : global.Backbone;

  (function($) {
    if (Backbone.controls == null) {
      Backbone.controls = {};
    }
    if (Backbone.interactions == null) {
      Backbone.interactions = {};
    }
    Backbone.CompositeView = (function(_super) {
      __extends(CompositeView, _super);

      function CompositeView() {
        return CompositeView.__super__.constructor.apply(this, arguments);
      }

      CompositeView.prototype.collection = null;

      CompositeView.prototype.__children = [];

      CompositeView.prototype.__parent = null;

      CompositeView.prototype.subviews = {};

      CompositeView.prototype.createChildren = function() {
        if (typeof this.subviews !== 'undefined' && (this.subviews != null) && _.isObject(this.subviews)) {
          _.each(this.subviews, ((function(_this) {
            return function(view, selector) {
              if (typeof view === 'undefined') {
                return;
              }
              return _.each(_this.$el.find(selector), function(v, k) {
                return _this.__children.push((_this[selector] = new view({
                  el: v,
                  __parent: _this
                })));
              });
            };
          })(this)));
          this.delegateEvents();
        }
        this.childrenComplete();
        return this.render();
      };

      CompositeView.prototype.getElement = function() {
        return this.$el;
      };

      CompositeView.prototype.setElement = function(el) {
        if (el) {
          this.$el = $(this.el = el);
        }
        this.delegateEvents();
        return this;
      };

      CompositeView.prototype.setCollection = function(c) {
        if (this.__collection) {
          this.__collection.off("change reset add remove");
        }
        (this.__collection = c).on("change reset add remove", this.render, this);
        return this;
      };

      CompositeView.prototype.getCollection = function() {
        return this.__collection;
      };

      CompositeView.prototype.getChildren = function() {
        return this.__children;
      };

      CompositeView.prototype.getChild = function(sel) {
        if (typeof clazz !== 'function') {
          throw 'clazz must be type <Function>';
        }
        return this.__children[sel] || null;
      };

      CompositeView.prototype.addChild = function(sel, clazz, opts) {
        if (typeof clazz !== 'function') {
          throw 'clazz must be type <Function>';
        }
        (this.subviews != null ? this.subviews : this.subviews = {})[sel] = clazz;
        if (!(((opts != null ? opts.create : void 0) != null) && opts.create === false)) {
          this.createChildren();
        }
        return this;
      };

      CompositeView.prototype.removeChild = function(sel, opts) {
        if (!sel) {
          return;
        }
        if (typeof sel === 'string') {
          if (this.__children[sel] != null) {
            this.__children[sel].remove();
            delete this.__children[sel];
          }
        } else {
          throw 'param sel must be CSS Selector String';
        }
        return this;
      };

      CompositeView.prototype.replaceChild = function(sel, clazz) {
        if (!((sel != null) && typeof sel === 'string')) {
          throw 'param sel must be CSS Selector String';
        }
        if (typeof sel === 'string' && clazz instanceof Backbone.View) {
          this.__children[sel] = clazz;
        }
        return this;
      };

      CompositeView.prototype.removeAllChildren = function() {
        var sel, _i, _len, _ref;
        _ref = _.keys(this.__children);
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          sel = _ref[_i];
          this.$(sel).remove();
          delete this[sel];
          delete this.__children[sel];
        }
        return this;
      };

      CompositeView.prototype.childrenComplete = function() {
        return this;
      };

      CompositeView.prototype.initialize = function(o) {
        _.extend(this, Backbone.Events);
        if ((o != null) && o.el) {
          this.setElement(o.el);
        }
        if ((o != null) && o.collection) {
          this.setCollection(o.collection);
        }
        if ((o != null) && o.__parent) {
          this.__parent = o.__parent;
        }
        if (typeof this.init === 'function') {
          if (o != null) {
            this.init(o);
          } else {
            this.init();
          }
        }
        return this.createChildren();
      };

      return CompositeView;

    })(Backbone.View);
    Backbone.interactions.Draggable = (function(_super) {
      __extends(Draggable, _super);

      function Draggable(__target, opts) {
        var _calcX, _calcY, _def;
        this.__target = __target;
        _def = {
          oRoot: this.__target,
          minX: 0,
          maxX: window.width,
          maxY: 0,
          maxY: window.height
        };
        _.extend(_def, opts);
        _.extend(this, Backbone.Events);
        _calcX = (function(_this) {
          return function(xPos) {
            var x;
            if (xPos < (x = _def.minX)) {
              return x;
            }
            if (xPos > (x = _def.maxX)) {
              return x;
            }
            return xPos;
          };
        })(this);
        _calcY = (function(_this) {
          return function(yPos) {
            var y;
            if (yPos < (y = _def.minY)) {
              return y;
            }
            if (yPos > (y = _def.maxY)) {
              return y;
            }
            return yPos;
          };
        })(this);
        this.__target.on('mousedown', (function(_this) {
          return function(evt) {
            _def.oRoot.addClass('drag-target');
            _this.trigger('dragStart', _this._target.offset());
            _this.__target.on('mousemove', function(evt) {
              var o;
              _this.__target.offset(o = {
                top: (_calcY(evt.pageY)) - $('.drag-target').outerHeight() / 2,
                left: (_calcX(evt.pageX)) - $('.drag-target').outerWidth() / 2
              });
              return _this.trigger('dragUpdate', o);
            });
            return _this.__target.on('mouseup', function(evt) {
              return _this.__target.on('mouseup', function(evt) {
                _def.oRoot.removeClass('drag-target').off('mousemove');
                return _this.trigger('dragStop', _this.__target.offset());
              });
            });
          };
        })(this));
      }

      return Draggable;

    })(Object);
    return 
	Backbone.controls.Checkbox = (function(_super) {
	  __extends(Checkbox, _super);
	
	  function Checkbox() {
	    return Checkbox.__super__.constructor.apply(this, arguments);
	  }
	
	  Checkbox.prototype.__opts = {
	    classes: '',
	    label: '',
	    id: '',
	    name: '',
	    checked: false
	  };
	
	  Checkbox.prototype.val = function(val) {
	    if (val != null) {
	      this.$el.find('input').val(val);
	      return this;
	    } else {
	      return this.$el.find('input').val();
	    }
	  };
	
	  Checkbox.prototype.render = function() {
	    this.$el.html(this.template(this.__opts));
	    this.delegateEvents();
	    return this;
	  };
	
	  Checkbox.prototype.initialize = function(opts) {
	    if (opts == null) {
	      opts = {};
	    }
	    _.extend(this.__opts, opts.params);
	    if (opts.el) {
	      this.$el = $(this.el = opts.el);
	    }
	    this.template = _.template(Backbone.controls.Checkbox.__template__);
	    return this.render();
	  };
	
	  return Checkbox;
	
	})(Backbone.View);
	
	Backbone.controls.Checkbox.__template__ = "<span class=\"checkbox-container\">\n  <label for=\"{{id || ''}}\">{{label}}</label>\n  <input type=\"checkbox\" name=\"{{name}}\" id=\"{{id || ''}}\" checked=\"{{ checked ? 'checked' : false}}\"/>\n  <div class=\"checkbox-symbol {{classes || ''}}\"></div>\n</span>";
	
	Backbone.controls.Panel = (function(_super) {
	  __extends(Panel, _super);
	
	  function Panel() {
	    return Panel.__super__.constructor.apply(this, arguments);
	  }
	
	  Panel.prototype.model = new (Backbone.Model.extend({
	    defaults: {
	      title: 'Panel',
	      collapsable: false,
	      minified: false
	    }
	  }));
	
	  Panel.prototype.events = {
	    'click .panel-header .help': function() {},
	    'click .panel-header .close': function() {},
	    'click .panel-header .expand': function() {},
	    'click .panel-header .collapse': function() {}
	  };
	
	  Panel.prototype.getCollection = function() {
	    var _ref;
	    return (_ref = this['.panel-content']) != null ? _ref.getCollection() : void 0;
	  };
	
	  Panel.prototype.setCollection = function(c) {
	    var _ref;
	    return (_ref = this['.panel-content']) != null ? _ref.setCollection(c) : void 0;
	  };
	
	  Panel.prototype.getChildren = function() {
	    var _ref;
	    return (_ref = this['.panel-content']) != null ? _ref.getChildren() : void 0;
	  };
	
	  Panel.prototype.addChild = function(sel, clazz, opts) {
	    var _ref;
	    return (_ref = this['.panel-content']) != null ? _ref.addChild(sel, clazz, opts) : void 0;
	  };
	
	  Panel.prototype.removeChild = function(sel, opts) {
	    var _ref;
	    return (_ref = this['.panel-content']) != null ? _ref.removeChild(sel, opts) : void 0;
	  };
	
	  Panel.prototype.replaceChild = function(sel, clazz) {
	    var _ref;
	    return (_ref = this['.panel-content']) != null ? _ref.replaceChild(sel, clazz) : void 0;
	  };
	
	  Panel.prototype.removeAllChildren = function() {
	    var _ref;
	    return (_ref = this['.panel-content']) != null ? _ref.removeAllChildren() : void 0;
	  };
	
	  Panel.prototype.render = function() {
	    var clazz, _ref, _t, _tpl;
	    Panel.__super__.render.call(this);
	    if (((clazz = Backbone.controls[Fun.getConstructorName(this)]) != null) && typeof (_t = clazz.__template__) === 'string') {
	      _tpl = _.template(_t);
	    }
	    this.$('.panel-content').html(_tpl(((_ref = this.model) != null ? _ref.attributes : void 0) != null ? this.model.attributes : {}));
	    _.each(this.subviews, (function(_this) {
	      return function(clazz, sel) {
	        if (_this[sel]) {
	          return _this.$('.panel-content').find(sel).append(_this[sel].$el);
	        }
	      };
	    })(this));
	    new Backbone.controls.Draggable(this.$('panel-header'), {
	      oRoot: this
	    });
	    return this;
	  };
	
	  Panel.prototype.initialize = function(o) {
	    var clazz, _t;
	    if (((clazz = Backbone.controls.Panel) != null) && typeof (_t = clazz.__template__) === 'string') {
	      this.template = _.template(_t);
	    }
	    return Panel.__super__.constructor.__super__.initialize.call(this, o);
	  };
	
	  return Panel;
	
	})(Backbone.CompositeView);
	
	Backbone.controls.Panel.__template__ = "<div class=\"Backbone.controls-panel {{minified ? 'minified' : ''}}\">\n  <div class=\"panel-header\">\n    <div class=\"panel-title-container\">\n      <h1 class=\"panel-title\">{{title}}</h1>\n    </div> \n  </div>\n  <div class=\"panel-content\">\n  </div>\n</div>";
	
	Backbone.controls.Slider = (function(_super) {
	  __extends(Slider, _super);
	
	  function Slider() {
	    return Slider.__super__.constructor.apply(this, arguments);
	  }
	
	  Slider.prototype.model = new (Backbone.Model.extend({
	    defaults: {
	      minValue: 0,
	      maxValue: 100,
	      value: 50
	    },
	    valueOf: function() {
	      return this.attributes.value || 0;
	    }
	  }));
	
	  Slider.prototype.minValue = function(v) {
	    if ((v != null) && typeof v === 'Number') {
	      this.model.set({
	        minValue: v
	      });
	      return this;
	    }
	    return this.attributes.minValue;
	  };
	
	  Slider.prototype.maxValue = function(v) {
	    if ((v != null) && typeof v === 'Number') {
	      this.model.set({
	        maxValue: v
	      });
	      return this;
	    }
	    return this.attributes.maxValue;
	  };
	
	  Slider.prototype.value = function(v) {
	    if ((v != null) && typeof v === 'Number') {
	      this.model.set({
	        value: v
	      });
	      return this;
	    }
	    return this.attributes.value;
	  };
	
	  Slider.prototype.subviews = {
	    '.bbui-slider-base': Backbone.controls._sliderBase
	  };
	
	  Slider.prototype.init = function(opts) {};
	
	  return Slider;
	
	})(Backbone.CompositeView);
	
	Backbone.controls.Slider.__template__ = "<div class=\"bbui-slider {{classes || \"\"}}>\n  <div class=\"bbui-slider-base\">\n    <div class=\"bbui-slider-ticks\"></div>\n  </div>\n</div>\"";
	
  })(jQuery);

}).call(this);
